
## **Overview**

This report is my brief analysis for the **RemcosRAT Downloader Script**.

In the analysis, I cover decoding process, including how to decode the following obfuscation methods:  

- URL encoding 
- Enormous Spacing  
- Base64 encoding

## **IOCS**

The sample I used is .HTA script.  

**MD5**: e22849cf884da37532e50f50a298c344



**SHA256**:
e15bf785da97ec4893315687222ab28f491b49de7e95558086cd59d23b85c057

**Sample**: 
https://bazaar.abuse.ch/sample/e15bf785da97ec4893315687222ab28f491b49de7e95558086cd59d23b85c057/

## **URL Encoding** 

The initial state of the .HTA file contains a small portion of HTML, followed by a large block of URL encoded characters. 

![[../../../assets/images/malware-analysis/RemcosRAT Downloader Script/Pasted image 20240925114958.png]]

To decode the URL encoded content I used CyberChef tool and URL decode operation.

As shown below, this decodes the content but exposes two additional layers of URL encoding.

![[../../../assets/images/malware-analysis/RemcosRAT Downloader Script/Pasted image 20240925115529.png]]


These two additional layers of URL encoding can be resolved with another URL Decode operation. 

![[../../../assets/images/malware-analysis/RemcosRAT Downloader Script/Pasted image 20240925120157.png]]

The content can now be moved back to a text editor for additional analysis.


## **Enormous spacing** 

Although the URL encoding has been removed from the script, it now uses large blocks of spaces to obstruct analysis, as shown in the screenshot below.

![[../../../assets/images/malware-analysis/RemcosRAT Downloader Script/Pasted image 20240925135040.png]]

The spacing can be manually removed by highlighting and deleting, I used a regular expression, more efficient method to remove occurrences of two or more whitespace characters \\s. 

By performing a find with \\s\\s+ expression, we can see 79 matches in entire file.  

![[../../../assets/images/malware-analysis/RemcosRAT Downloader Script/Pasted image 20240925135233.png]]


By performing a replace with \\s\\s+ expression, the content can be cleaned up significantly.

![[../../../assets/images/malware-analysis/RemcosRAT Downloader Script/Pasted image 20240925135702.png]]

![[../../../assets/images/malware-analysis/RemcosRAT Downloader Script/Pasted image 20240925135757.png]]


## **Base64 encoding** 

The resulting content shows a large blob of Base64 data, 'fROmbasE64STring,' with random upper and lower case letters.

![[../../../assets/images/malware-analysis/RemcosRAT Downloader Script/Pasted image 20240925135951.png]]

To decode the Base64 encoded content I used CyberChef tool and Base64 decode operation.

![[../../../assets/images/malware-analysis/RemcosRAT Downloader Script/Pasted image 20240925140141.png]]

The resulting content has extra spacing, which can be fixed by using the same regular expression technique as before.

![[../../../assets/images/malware-analysis/RemcosRAT Downloader Script/Pasted image 20240925140304.png]]

After removing the spacing, it's clear the code is a downloader using the URLDownloadToFile function. 

The address of the next stage file contains the following value: 
http://134[.]255[.]227[.]248/xampp/kb/nicepicturewithherimagesgood[.]tIF

